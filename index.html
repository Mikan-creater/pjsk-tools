<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>プロセカイベントP倍率計算</title>

<style>
body{
  background:#0f172a;
  color:#e5e7eb;
  font-family:"Segoe UI",sans-serif;
  margin:0;
  padding:20px;
}

h1{
  text-align:center;
  margin-bottom:30px;
  font-size:28px;
  color:#38bdf8;
  text-shadow:0 0 8px #38bdf8;
}

h2{
  margin-bottom:10px;
  color:#facc15;
  font-size:20px;
}

.section{
  background:#111827;
  border:1px solid #334155;
  border-radius:10px;
  padding:15px;
  margin-bottom:25px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:12px;
}

.card{
  border:1px solid #334155;
  border-radius:10px;
  padding:10px;
  background:#020617;
}

.card b{
  display:block;
  margin-bottom:6px;
  color:#f472b6;
  font-size:16px;
}

label{
  font-size:13px;
  color:#94a3b8;
}

select{
  width:100%;
  margin-bottom:6px;
  background:#0f172a;
  color:#fff;
  border:1px solid #334155;
  border-radius:5px;
  padding:3px;
}

.result{
  text-align:right;
  font-size:15px;
  font-weight:bold;
  color:#22c55e;
}

.total{
  text-align:right;
  font-size:20px;
  margin-top:10px;
  color:#facc15;
  font-weight:bold;
}

textarea{
  width:100%;
  height:150px;
  background:#020617;
  color:#e5e7eb;
  border:1px solid #334155;
  border-radius:8px;
  padding:10px;
  resize:vertical;
}
</style>
</head>

<body>

<h1>プロセカイベントP倍率計算</h1>

<div class="section">
<h2>メインユニット</h2>
<div id="main" class="grid"></div>
<div class="total">合計倍率：<span id="mainTotal">0</span>%</div>
</div>

<div class="section">
<h2>サポートユニット</h2>
<div id="support" class="grid"></div>
<div class="total">合計倍率：<span id="supportTotal">0</span>%</div>
</div>

<div class="section">
<h2>Info</h2>
<textarea readonly>
【使い方】
①メインユニット・サポートユニット(ワールドリンクの時のみ)の各項目を選択します
②選択すると自動でイベントP倍率が計算されます
③編成ごとの合計倍率が下に表示されます

・⭕は対象ボーナスあり、❌は対象ボーナスなし
・指定キャラクター・タイプはイベントで対象になっているキャラクター・タイプ、指定PUメンバーはイベントのガチャなどでPUされているメンバーを編成したときに得られるボーナスです

※通常イベントの場合はメインユニットのみ、ワールドリンクの場合はサポートユニットを編成し、それも含めた倍率を参考にしてください

【アップデート情報】
Ver.1.0.0　計算機能実装
</textarea>
</div>

<script>
const rarityList=["☆1","☆2","☆3","BD/AN","☆4"]

function createMain(){
  const area=document.getElementById("main")
  for(let i=0;i<5;i++){
    area.innerHTML+=`
    <div class="card mainCard">
    <b>メイン${i+1}</b>

    <label>レアリティー</label>
    <select class="rarity">${rarityList.map(r=>`<option>${r}</option>`).join("")}</select>

    <label>マスターランク</label>
    <select class="mr">${[0,1,2,3,4,5].map(n=>`<option>${n}</option>`).join("")}</select>

    <label>指定キャラクター</label>
    <select class="char"><option>❌</option><option>⭕</option></select>

    <label>指定PUメンバー</label>
    <select class="mem"><option>❌</option><option>⭕</option></select>

    <label>指定タイプ</label>
    <select class="type"><option>❌</option><option>⭕</option></select>

    <div class="result">0%</div>
    </div>`
  }
}

function createSupport(){
  const area=document.getElementById("support")
  for(let i=0;i<20;i++){
    area.innerHTML+=`
    <div class="card supportCard">
    <b>サポート${i+1}</b>

    <label>レアリティー</label>
    <select class="rarity">${rarityList.map(r=>`<option>${r}</option>`).join("")}</select>

    <label>マスターランク</label>
    <select class="mr">${[0,1,2,3,4,5].map(n=>`<option>${n}</option>`).join("")}</select>

    <label>スキルレベル</label>
    <select class="lv">${[1,2,3,4].map(n=>`<option>${n}</option>`).join("")}</select>

    <label>指定キャラクター</label>
    <select class="char"><option>❌</option><option>⭕</option></select>

    <label>ユニイベ限定メンバー</label>
    <select class="lim"><option>❌</option><option>⭕</option></select>

    <div class="result">0%</div>
    </div>`
  }
}

createMain()
createSupport()

document.addEventListener("change",calc)

function calc(){

let mainTotal=0

document.querySelectorAll(".mainCard").forEach(card=>{

const rarity=card.querySelector(".rarity").value
const mr=Number(card.querySelector(".mr").value)
const char=card.querySelector(".char").value==="⭕"
const mem=card.querySelector(".mem").value==="⭕"
const type=card.querySelector(".type").value==="⭕"

let total=0

if(rarity==="BD/AN") total+=5
if(rarity==="☆4") total+=10

const skillTable={"☆1":0.1,"☆2":0.2,"☆3":1,"BD/AN":2}

if(rarity==="☆4"){
if(mr<=4){
total+=mr*2.5
}else{
total+=4*2.5+5
}
}else{
total+=mr*skillTable[rarity]
}

if(char) total+=25
if(mem) total+=20
if(type) total+=25

card.querySelector(".result").textContent=total+"%"
mainTotal+=total

})

document.getElementById("mainTotal").textContent=mainTotal.toFixed(2)


let supportTotal=0

document.querySelectorAll(".supportCard").forEach(card=>{

const rarity=card.querySelector(".rarity").value
const mr=Number(card.querySelector(".mr").value)
const lv=Number(card.querySelector(".lv").value)
const char=card.querySelector(".char").value==="⭕"
const lim=card.querySelector(".lim").value==="⭕"

let total=0

const rarityBonus={"☆1":0.5,"☆2":1,"☆3":2,"BD/AN":5,"☆4":7.5}
total+=rarityBonus[rarity]

const mrTable={
"☆1":[0,0.1,0.1,0.2,0.2,0.3],
"☆2":[0,0.2,0.2,0.3,0.4,0.5],
"☆3":[0,0.3,0.4,0.6,0.8,1],
"BD/AN":[0,0.4,0.8,1.2,1.6,2],
"☆4":[0,0.5,1,1.5,2,2.5]
}

total+=mrTable[rarity][mr]

const lvTable={
"☆1":[0,0,0.05,0.1,0.3],
"☆2":[0,0,0.1,0.2,0.5],
"☆3":[0,0,0.15,0.4,1],
"BD/AN":[0,0,0.2,0.8,2],
"☆4":[0,0,0.25,1,2.5]
}

total+=lvTable[rarity][lv]

if(char) total+=5
if(lim) total+=20

card.querySelector(".result").textContent=total+"%"
supportTotal+=total

})

document.getElementById("supportTotal").textContent=supportTotal.toFixed(2)

}

calc()
</script>

</body>
</html>
